#!/bin/bash

#
# Init script for <%= project %>
#

SERVER="<%= server.url %>"
PORT="<%= server.port %>"
PROJECT="<%= project %>"

# Check to see if server is reachable
echo ""
echo "[Step 0] - Testing file host server..."
wget ${SERVER}:${PORT}/ -O temp.file --timeout=1 --quiet
if [ -f temp.file ]
    then
        echo "Server connection successful..."
        rm temp.file
    else
        echo "Server not reachable, exiting init script..."
        exit 1
fi

# Fetch each file from the server
<% _.each(files, function(file_info) { -%>
curl ${SERVER}:${PORT}/get_file/${PROJECT}/<%= file_info.path %> --silent --create-dirs -z <%= file_info.path %> -o <%= file_info.path %>
<% }); -%>

# To build, all we need to do is usually run Make